name: 🛠️ Migrate to Android v2 Embedding

on:
  workflow_dispatch:

jobs:
  migrate:
    name: 🔄 Fix Android Embedding
    runs-on: ubuntu-latest

    steps:
      - name: 📥 Checkout Project
        uses: actions/checkout@v3

      - name: 🚀 Set Up Flutter
        uses: subosito/flutter-action@v2
        with:
          channel: stable

      - name: 🧼 Delete old android/ folder
        run: rm -rf android

      - name: 🛠️ Create new Flutter project to extract Android v2
        run: flutter create temp_app

      - name: 🔁 Copy android/ from fresh app
        run: cp -r temp_app/android ./android

      - name: 🧹 Remove temp app
        run: rm -rf temp_app

      - name: 📝 Commit migration
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "🚀 Migrated Android project to embedding v2"
