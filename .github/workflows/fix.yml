name: ğŸ› ï¸ Migrate to Android v2 Embedding

on:
  workflow_dispatch:

jobs:
  migrate:
    name: ğŸ”„ Fix Android Embedding
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout Project
        uses: actions/checkout@v3

      - name: ğŸš€ Set Up Flutter
        uses: subosito/flutter-action@v2
        with:
          channel: stable

      - name: ğŸ§¼ Delete old android/ folder
        run: rm -rf android

      - name: ğŸ› ï¸ Create new Flutter project to extract Android v2
        run: flutter create temp_app

      - name: ğŸ” Copy android/ from fresh app
        run: cp -r temp_app/android ./android

      - name: ğŸ§¹ Remove temp app
        run: rm -rf temp_app

      - name: ğŸ“ Commit migration
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ğŸš€ Migrated Android project to embedding v2"
